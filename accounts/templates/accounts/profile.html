{% extends 'base.html' %}
{% block content %}

<!-- Header -->
<div class="mb-6">
  <h1 class="text-2xl font-semibold tracking-tight">Your Profile</h1>
  <p class="text-slate-500 text-sm" style="color: black;">Account information pulled directly from the database.</p>
</div>

<!-- Top Summary Card -->
<section class="bg-white shadow rounded-2xl ring-1 ring-slate-100 overflow-hidden">
  <div class="p-6 flex items-center gap-4">
    <!-- Avatar initials -->
    <div class="h-14 w-14 rounded-xl bg-brand-600 text-white flex items-center justify-center text-xl font-bold select-none">
      {{ profile.full_name|default:request.user.email|first|upper }}
    </div>

    <div class="flex-1 min-w-0">
      <div class="flex items-center flex-wrap gap-2">
        <h2 class="text-lg font-semibold truncate">{{ profile.full_name }}</h2>
        {% if profile.medical_license %}
          <span class="inline-flex items-center rounded-full bg-emerald-50 text-emerald-700 px-2 py-0.5 text-xs">
            Legacy License: {{ profile.medical_license }}
          </span>
        {% endif %}
      </div>
      <div class="mt-1 text-sm text-slate-600 truncate">{{ request.user.email }}</div>
      <div class="text-xs text-slate-400 mt-0.5">
        Member since {{ request.user.date_joined|date:"M j, Y" }}
      </div>
    </div>

    <!-- Actions -->
    <div class="flex items-center gap-2">
      <a href="{% url 'accounts:profile_edit' %}" class="inline-flex items-center rounded-lg bg-brand-600 hover:bg-brand-700 px-3 py-1.5 text-sm text-white">Edit Profile</a>
      <a href="/" class="inline-flex items-center rounded-lg bg-slate-100 hover:bg-slate-200 px-3 py-1.5 text-sm">Dashboard</a>
      <a href="{% url 'accounts:logout' %}" class="inline-flex items-center rounded-lg bg-red-50 text-red-700 hover:bg-red-100 px-3 py-1.5 text-sm">Logout</a>
    </div>
  </div>
</section>

<!-- Details Grid -->
<section class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-6">

  <!-- Contact / Identity -->
  <div class="bg-white shadow rounded-2xl ring-1 ring-slate-100">
    <div class="px-6 py-4 border-b border-slate-100">
      <h3 class="text-sm font-semibold text-slate-700">Contact Information</h3>
    </div>
    <div class="p-6 text-sm">
      <dl class="grid grid-cols-1 gap-4">
        <div>
          <dt class="text-slate-500">Full Name</dt>
          <dd class="font-medium text-slate-900">{{ profile.full_name }}</dd>
        </div>

        <div class="flex items-start justify-between gap-3">
          <div>
            <dt class="text-slate-500">Email</dt>
            <dd class="font-medium text-slate-900 break-all" id="emailValue">{{ request.user.email }}</dd>
          </div>
          <button type="button" class="text-xs px-2 py-1 rounded-md bg-slate-100 hover:bg-slate-200"
                  data-copy="#emailValue">Copy</button>
        </div>

        <div class="flex items-start justify-between gap-3">
          <div>
            <dt class="text-slate-500">Phone</dt>
            <dd class="font-medium text-slate-900" id="phoneValue">{{ profile.phone|default:"—" }}</dd>
          </div>
          {% if profile.phone %}
            <button type="button" class="text-xs px-2 py-1 rounded-md bg-slate-100 hover:bg-slate-200"
                    data-copy="#phoneValue">Copy</button>
          {% endif %}
        </div>

        <div>
          <dt class="text-slate-500">Address</dt>
          <dd class="font-medium text-slate-900 whitespace-pre-line">{{ profile.address|default:"—" }}</dd>
        </div>
      </dl>
    </div>
  </div>

  <!-- Govt Proof / Professional -->
  <div class="bg-white shadow rounded-2xl ring-1 ring-slate-100">
    <div class="px-6 py-4 border-b border-slate-100">
      <h3 class="text-sm font-semibold text-slate-700">Govt Proof & Professional</h3>
    </div>
    <div class="p-6 text-sm space-y-4">
      <div>
        <div class="text-slate-500">Govt ID Type</div>
        <div class="font-medium text-slate-900">{{ profile.gov_id_type|default:"—" }}</div>
      </div>

      <div>
        <div class="text-slate-500">Govt ID Document</div>
        {% if profile.gov_id_file %}
          <a href="{{ profile.gov_id_file.url }}" class="text-brand-700 hover:underline" target="_blank" rel="noopener">
            Download / View
          </a>
        {% else %}
          <div class="font-medium text-slate-900">—</div>
        {% endif %}
        <p class="text-xs text-slate-500 mt-1">You can change this from the Edit Profile page.</p>
      </div>
    </div>
  </div>

</section>

<!-- Small JS: Copy buttons -->
<script>
  (function () {
    function copyFrom(selector) {
      const el = document.querySelector(selector);
      if (!el) return;
      const text = (el.textContent || '').trim();
      if (!text) return;
      if (navigator.clipboard && navigator.clipboard.writeText) {
        navigator.clipboard.writeText(text);
      }
    }
    document.addEventListener('click', (e) => {
      const btn = e.target.closest('[data-copy]');
      if (!btn) return;
      e.preventDefault();
      copyFrom(btn.getAttribute('data-copy'));
    });
  })();
</script>

{% endblock %}
